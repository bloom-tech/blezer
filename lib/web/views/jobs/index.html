{% extends "base.html" %}
{% block content %}
{% set nav = { active: status } %}
{% include "_partials/nav.html" %}
<div class="container-fluid">
  <div class="row">
    <main class="col-sm-12 pt-3">
      <form action='/jobs?status={{ status }}' method='POST'>
        <button type='submit' class="btn btn-danger">Remove all</button>
      </form>

      <div id="job-list" class="table-responsive">
        <input class="search" />
        <table class="table table-hover">
          <thead>
            <tr>
              <th width=100>JID</th>
              <th width=100>Queue</th>
              <th>Task</th>
              <th>Args</th>
              <th>Started</th>
              <th>%</th>
              <th></th>
            </tr>
          </thead>
          <tbody class="list">
            {% for job in jobs %}
            <tr>
              <th scope="row" class="jid">
                <a href="/jobs/{{ job.jid }}" title="{{ job.jid }}">
                  {{ job.jid | truncate(8, true) }}
                  </a>
              </th>
              <td class="queue">{{ job.queue | name }}</td>
              <td class="task">{{ job.task }}</td>
              <td class="args" title="{{ job.args | dump(2) }}"><code>{{ job.args | dump(2) | truncate(100, true) }}</code></td>
              <td class="queue">{{ job.startedAt | date }}</td>
              <td>{{ job.progress }}</td>
              <td class="pull-right">
                <div class="btn-group" role="group">
                  <a href="/jobs/{{ job.jid }}" class="btn btn-outline-primary btn-sm">Show</a>
                  <form
                    action='/jobs/{{ job.jid }}/delete?status={{ status }}'
                    onsubmit="return confirm('Are you sure you want to delete this job?');"
                    method='POST'
                    class="d-inline">
                    <button type='submit' class="btn btn-sm btn-danger">Remove</button>
                  </form>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </main>
  </div>
</div>
{% endblock %}
